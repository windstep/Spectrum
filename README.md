# Spectrum

## Установка на windows

Все манипуляции проделываются в директории с проектом (shift + ПКМ на папке с кодом - открыть powershell здесь)

1. Установите себе на компьютер nodejs - nodejs.org
2. Скопируйте данный репозиторий (вверху есть кнопка code - download zip), распакуйте скачанный архив в нужную вам папку. Все дальнейшие манипуляции, включая запуск бота будут осуществляться в ней.
3. Сгенерируйте себе самоподписанный SSL-сертификат.
   1. Скачайте портированную версию openssl с https://slproweb.com/products/Win32OpenSSL.html в .msi версии
   2. Установите и добавьте ее в переменные среды (откройте "Мой компьютер", клик правой кнопкой мыши в свободное место, свойства, изменить параметры, дополнительно, переменные среды, найдите Path в верхней части окошка, двойной клик, в открывшемся попапе - создать, изменить, дойдите до папки с установленным openssl в ней подпапка bin - C:\Program Files\OpenSSL-Win64\bin - путь по умолчанию, ок)
   3. Переоткройте терминал в папке (инструкция в самом верху)
   4. Сгенерируйте ключ командой `openssl req -x509 -newkey rsa:4096 -sha256 -keyout key.pem -out cert.pem -subj "/CN=company.co.nz" -days 600`
   5. Обязательно введите passphrase, иначе не сработает. Любые рандомные 5 букво-цифр, но запомните их.
   6. Откройте файл environment.js и в нем найдите configurationProduction, в нем найдите passphrase и вставьте ее туда.
4. Создайте бота в discord.
   1. https://discord.com/developers/applications/
   2. new application справа сверху
   3. Вводите удобное имя
   4. переходите в секцию BOT и в ней нажимаете кнопку создать бота, соглашаетесь с условиями.
   5. Кликаете `reset token`, соглашаетесь с условиями, копируете токен и вставляете его в файл `environment.js` в секцию `configurationProduction` в поле botToken
   6. Включаете нужные intent-ы - server members и message content, не забываете сохранить изменения.
   7. Оставьте страницу с ботом открытой - она вам еще понадобится.
5. Создадим приложение eve online
   1. https://developers.eveonline.com/
   2. Логинитесь (справа сверху - login with eve online)
   3. Нажимаете большую кнопку manage applications
   4. Вводите рандомное имя приложения, описание в пару строк, выбираете Authentication & API access
   5. Перебрасываете все permissions (пока так, я не знаю, какие скоупы нужны приложению, если честно, поэтому проще перекидать все) в правый столбец
   6. В callback uri вводите https://127.0.0.1:3003/spectrum/authentication/
   7. Еще раз переходите в manage applications, находите свое приложение, заходите в него, находите 2 параметра: client id и secret key
   8. По очереди копируете и сохраняете в `environment.js` в секцию `configurationProduction`, в `uid` и `secret` соотвественно
6. Вызовите команду `npm i`
7. Запустите бота командой `./run.cmd` вы должны увидеть фразу `[STARTUP] Discord bot is logged in on 0 server(s)`
8. Теперь присоединим бота к серверу. Для этого нам потребуется линк. Линк формируется так:
   1. Откройте оставленную ранее на 4 этапе открытую страницу с ботом
   2. Выставьте настройки: bot (в появившемся ниже окне выберите пункт Administrator) и applications.commands
   3. Скопируйте получившийся токен авторизации и вставьте его в новой странице браузера
   4. Посмотрите в свою консоль (powershell) - там вы должны увидеть фразу `[EVENT] Bot joined server: <название вашего сервера>`
   5. Страницу в браузере можно закрыть.
9. Теперь, когда бот присоединен приступим к его настройке. Для этого в любом текстовом чате наберите `!auth`
10. Для настройки - !config

